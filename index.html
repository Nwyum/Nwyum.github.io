<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026è·¨å¹´è¡¨ç™½</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        /* éŸ³ä¹æ§åˆ¶æŒ‰é’® */
        .music-btn {
            position: fixed;
            top: 70px;
            right: 15px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255, 107, 157, 0.3);
            border: 2px solid rgba(255, 107, 157, 0.6);
            color: #ff6b9d;
            font-size: 1.3rem;
            cursor: pointer;
            z-index: 500;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .music-btn:hover {
            background: rgba(255, 107, 157, 0.5);
            transform: scale(1.1);
        }
        
        
        .music-btn.playing {
            animation: musicPulse 1s ease-in-out infinite;
        }
        
        @keyframes musicPulse {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 107, 157, 0.5); }
            50% { box-shadow: 0 0 25px rgba(255, 107, 157, 0.8); }
        }
        
        /* çˆ±å¿ƒæ¥åŠ›æ¸¸æˆ */
        .game-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 15;
            overflow: hidden;
        }
        
        .game-container.active {
            pointer-events: auto;
        }
        
        .game-ui {
            position: fixed;
            top: 15px;
            left: 15px;
            right: 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            z-index: 520;
            pointer-events: none;
        }
        
        .game-score {
            background: rgba(255, 107, 157, 0.3);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 107, 157, 0.6);
            border-radius: 15px;
            padding: 8px 15px;
            color: #ff6b9d;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .game-score .score-value {
            font-size: 1.3rem;
            color: #ffd700;
        }
        
        .game-lives {
            background: rgba(255, 107, 157, 0.3);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 107, 157, 0.6);
            border-radius: 15px;
            padding: 8px 15px;
            font-size: 1.2rem;
        }
        
        .game-hint {
            position: fixed;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 107, 157, 0.2);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 107, 157, 0.4);
            border-radius: 20px;
            padding: 8px 20px;
            color: #ffb6c1;
            font-size: 0.85rem;
            z-index: 520;
            animation: hintPulse 2s ease-in-out infinite;
            text-align: center;
            max-width: 90%;
        }
        
        @keyframes hintPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        /* çˆ±å¿ƒç¯®å­ */
        .heart-catcher {
            position: absolute;
            bottom: 30px;
            width: 80px;
            height: 60px;
            font-size: 3rem;
            text-align: center;
            line-height: 60px;
            z-index: 18;
            transition: left 0.05s linear;
            filter: drop-shadow(0 0 15px rgba(255, 107, 157, 0.8));
            user-select: none;
            -webkit-user-select: none;
        }
        
        .heart-catcher::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 8px;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 157, 0.6), transparent);
            border-radius: 50%;
        }
        
        /* æ‰è½çš„çˆ±å¿ƒ */
        .falling-heart {
            position: absolute;
            font-size: 1.8rem;
            user-select: none;
            filter: drop-shadow(0 0 8px rgba(255, 107, 157, 0.8));
            z-index: 16;
            pointer-events: none;
        }
        
        .falling-heart.special {
            font-size: 2.2rem;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 1));
            animation: specialGlow 0.5s ease-in-out infinite alternate;
        }
        
        @keyframes specialGlow {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
        
        .falling-heart.caught {
            animation: heartCaught 0.3s ease-out forwards;
        }
        
        @keyframes heartCaught {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.8; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .falling-heart.missed {
            animation: heartMissed 0.3s ease-out forwards;
        }
        
        @keyframes heartMissed {
            0% { opacity: 1; }
            100% { opacity: 0; transform: translateY(20px); }
        }
        
        /* ç‚¸å¼¹ */
        .falling-bomb {
            position: absolute;
            font-size: 2rem;
            user-select: none;
            z-index: 16;
            pointer-events: none;
            animation: bombShake 0.3s ease-in-out infinite;
        }
        
        @keyframes bombShake {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }
        
        .falling-bomb.explode {
            animation: bombExplode 0.4s ease-out forwards;
        }
        
        @keyframes bombExplode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(2); opacity: 0.8; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .score-popup {
            position: fixed;
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffd700;
            pointer-events: none;
            z-index: 530;
            animation: scoreFloat 0.8s ease-out forwards;
        }
        
        .score-popup.negative {
            color: #ff4444;
        }
        
        @keyframes scoreFloat {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        
        .combo-text {
            position: fixed;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            pointer-events: none;
            z-index: 540;
            animation: comboShow 0.8s ease-out forwards;
        }
        
        @keyframes comboShow {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            30% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }
        
        /* æ¸¸æˆç»“æŸå¼¹çª— */
        .game-over-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.3), rgba(138, 43, 226, 0.3));
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 107, 157, 0.6);
            border-radius: 25px;
            padding: 25px 35px;
            text-align: center;
            z-index: 550;
            display: none;
        }
        
        .game-over-popup.show {
            display: block;
            animation: popupIn 0.4s ease;
        }
        
        @keyframes popupIn {
            from { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .game-over-popup h3 {
            color: #ff6b9d;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .game-over-popup .final-score {
            font-size: 2.5rem;
            color: #ffd700;
            margin: 15px 0;
        }
        
        .game-over-popup .restart-btn {
            background: linear-gradient(45deg, #ff6b9d, #ff8a80);
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s;
        }
        
        .game-over-popup .restart-btn:hover {
            transform: scale(1.05);
        }
        
        @media (max-width: 480px) {
            .heart-catcher { width: 70px; font-size: 2.5rem; bottom: 25px; }
            .game-hint { font-size: 0.75rem; bottom: 100px; }
            .game-score { padding: 6px 12px; font-size: 0.8rem; }
            .game-score .score-value { font-size: 1.1rem; }
            .game-lives { padding: 6px 12px; font-size: 1rem; }
            .combo-text { font-size: 1.5rem; }
        }
        
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);
            color: white;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .stars {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        /* å€’è®¡æ—¶é¡µé¢ */
        .countdown-page {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        .countdown-page.hidden { display: none; }
        
        .year-title {
            font-size: 4rem;
            color: #ff6b9d;
            text-shadow: 0 0 30px rgba(255, 107, 157, 0.8);
            margin-bottom: 30px;
        }
        
        .countdown-display {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .time-box {
            background: rgba(255, 107, 157, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 107, 157, 0.5);
            border-radius: 15px;
            padding: 20px 25px;
            text-align: center;
            min-width: 90px;
        }
        
        .time-value {
            font-size: 3rem;
            font-weight: bold;
            color: #ff6b9d;
        }
        
        .time-label {
            font-size: 1rem;
            color: rgba(255,255,255,0.8);
            margin-top: 5px;
        }
        
        /* æœ€å10ç§’å¤§å€’è®¡æ—¶ */
        .final-countdown {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20rem;
            font-weight: bold;
            color: #ff6b9d;
            text-shadow: 0 0 100px rgba(255, 107, 157, 1);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
        }
        
        .final-countdown.show {
            animation: countPulse 1s ease-out forwards;
        }
        
        @keyframes countPulse {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        /* 2026æ–°å¹´æ˜¾ç¤º */
        .new-year {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b9d, #ff8a80, #ffab91, #ff6b9d);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            z-index: 90;
            opacity: 0;
            animation: gradient 2s ease infinite;
        }
        
        .new-year.show {
            animation: yearShow 1.5s ease forwards, gradient 2s ease infinite;
        }
        
        .new-year.move-up {
            animation: moveUp 1s ease forwards, gradient 2s ease infinite;
        }
        
        @keyframes yearShow {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        @keyframes moveUp {
            to { top: 5%; font-size: 3rem; opacity: 1; transform: translate(-50%, 0); }
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* ç¥ç¦å¼¹çª— */
        .blessing-popup {
            position: fixed;
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.25), rgba(255, 138, 128, 0.25));
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 107, 157, 0.4);
            border-radius: 10px;
            padding: 6px 10px;
            z-index: 50;
            opacity: 0;
            transform: scale(0);
            animation: popIn 0.4s ease forwards;
            box-shadow: 0 3px 15px rgba(255, 107, 157, 0.3);
            text-align: center;
        }
        
        @keyframes popIn {
            0% { opacity: 0; transform: scale(0); }
            70% { transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .blessing-popup .emoji { font-size: 1.1rem; }
        .blessing-popup .text { font-size: 0.7rem; color: #ffb6c1; font-weight: bold; display: block; }
        
        /* çƒŸèŠ± */
        .firework { position: fixed; pointer-events: none; z-index: 60; }
        .firework-particle { position: absolute; width: 5px; height: 5px; border-radius: 50%; }
        
        /* çˆ±å¿ƒé£˜è½ */
        .heart-rain {
            position: fixed;
            font-size: 1.5rem;
            z-index: 40;
            pointer-events: none;
            animation: heartFall linear forwards;
        }
        
        @keyframes heartFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0.3; }
        }

        /* è¡¨ç™½å¼¹çª— */
        .proposal-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
        
        .proposal-modal.show { display: flex; }
        
        .proposal-box {
            background: linear-gradient(135deg, #2d1b4e, #1a0a2e);
            border: 3px solid #ff6b9d;
            border-radius: 30px;
            padding: 40px;
            text-align: center;
            max-width: 450px;
            box-shadow: 0 0 50px rgba(255, 107, 157, 0.5);
            animation: proposalIn 0.5s ease;
        }
        
        @keyframes proposalIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .proposal-box h2 { font-size: 1.8rem; color: #ff6b9d; margin-bottom: 15px; }
        .proposal-box .question { font-size: 1.5rem; color: white; margin: 25px 0; line-height: 1.6; }
        .proposal-box .question .highlight { color: #ff6b9d; font-weight: bold; }
        
        .proposal-buttons { display: flex; gap: 25px; justify-content: center; margin-top: 25px; }
        
        .btn-yes, .btn-no {
            padding: 12px 40px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .btn-yes {
            background: linear-gradient(45deg, #ff6b9d, #ff8a80);
            color: white;
            box-shadow: 0 5px 20px rgba(255, 107, 157, 0.5);
        }
        
        .btn-yes:hover { transform: scale(1.1); }
        .btn-no { background: #666; color: white; }
        .reject-message { color: #ffb6c1; font-size: 1.1rem; margin-top: 15px; min-height: 25px; }
        
        /* æˆåŠŸé¡µé¢ */
        .success-page {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 300;
            flex-direction: column;
            overflow: hidden;
        }
        
        .success-page.show { display: flex; }
        
        .success-stars, .floating-hearts {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        
        .success-content {
            text-align: center;
            z-index: 10;
            animation: successFadeIn 1s ease forwards;
        }
        
        @keyframes successFadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .big-heart { font-size: 6rem; animation: heartFloat 2s ease-in-out infinite; display: inline-block; }
        
        @keyframes heartFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-15px) scale(1.1); }
        }
        
        .success-title {
            font-size: 3rem;
            background: linear-gradient(45deg, #ff6b9d, #ff8a80, #ffab91, #f48fb1);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient 3s ease infinite;
            margin: 15px 0;
        }
        
        .success-box {
            background: rgba(255, 107, 157, 0.15);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 107, 157, 0.4);
            border-radius: 25px;
            padding: 30px 50px;
            margin-top: 20px;
            max-width: 550px;
        }
        
        .success-box p { font-size: 1.2rem; color: rgba(255,255,255,0.95); line-height: 2; margin: 8px 0; }
        .success-box .highlight { color: #ff6b9d; font-weight: bold; }
        
        .together-date {
            display: inline-block;
            background: linear-gradient(45deg, #ff6b9d, #ff8a80);
            padding: 10px 25px;
            border-radius: 50px;
            margin-top: 20px;
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        .love-promise { margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255,107,157,0.3); }
        .love-promise p { font-size: 1.1rem; color: #ffb6c1; font-style: italic; }
        
        .wechat-tip {
            margin-top: 25px;
            padding: 15px 25px;
            background: rgba(7, 193, 96, 0.2);
            border: 2px solid rgba(7, 193, 96, 0.5);
            border-radius: 15px;
            color: #7fff7f;
        }
        
        .wechat-tip p { color: #7fff7f; font-size: 1rem; }
        
        .floating-heart {
            position: absolute;
            font-size: 2rem;
            animation: floatUp 4s ease-in-out infinite;
            opacity: 0.7;
        }
        
        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        /* å¹³æ¿é€‚é… */
        @media (max-width: 768px) {
            .year-title { font-size: 2.2rem; }
            .countdown-display { gap: 10px; }
            .time-box { padding: 15px; min-width: 65px; }
            .time-value { font-size: 1.8rem; }
            .final-countdown { font-size: 10rem; }
            .new-year { font-size: 4rem; }
            .new-year.move-up { font-size: 1.8rem; }
            .blessing-popup { padding: 3px 5px; }
            .blessing-popup .emoji { font-size: 0.8rem; }
            .blessing-popup .text { font-size: 0.5rem; }
            .proposal-box { padding: 25px; margin: 15px; }
            .proposal-box h2 { font-size: 1.4rem; }
            .proposal-box .question { font-size: 1.2rem; }
            .btn-yes, .btn-no { padding: 10px 30px; font-size: 1rem; }
            .big-heart { font-size: 4rem; }
            .success-title { font-size: 1.8rem; }
            .success-box { padding: 20px 25px; margin: 0 15px; }
            .success-box p { font-size: 1rem; }
            .together-date { font-size: 0.9rem; padding: 8px 18px; }
            .wechat-tip p { font-size: 0.9rem; }
        }
        
        /* æ‰‹æœºé€‚é… */
        @media (max-width: 480px) {
            .year-title { font-size: 1.6rem; }
            .countdown-display { gap: 6px; flex-wrap: wrap; justify-content: center; }
            .time-box { padding: 10px 12px; min-width: 60px; }
            .time-value { font-size: 1.5rem; }
            .time-label { font-size: 0.8rem; }
            .final-countdown { font-size: 8rem; }
            .new-year { font-size: 3rem; }
            .new-year.move-up { font-size: 1.5rem; top: 3%; }
            .blessing-popup { padding: 2px 4px; border-radius: 6px; }
            .blessing-popup .emoji { font-size: 0.7rem; }
            .blessing-popup .text { font-size: 0.45rem; }
            .proposal-box { padding: 20px 15px; margin: 10px; border-radius: 20px; }
            .proposal-box h2 { font-size: 1.2rem; }
            .proposal-box .question { font-size: 1rem; margin: 15px 0; }
            .proposal-buttons { gap: 15px; flex-wrap: wrap; }
            .btn-yes, .btn-no { padding: 10px 25px; font-size: 0.95rem; }
            .reject-message { font-size: 0.9rem; }
            .big-heart { font-size: 3rem; }
            .success-title { font-size: 1.5rem; }
            .success-box { padding: 15px 18px; margin: 0 10px; border-radius: 20px; }
            .success-box p { font-size: 0.9rem; line-height: 1.8; }
            .together-date { font-size: 0.8rem; padding: 8px 15px; margin-top: 15px; }
            .love-promise { margin-top: 15px; padding-top: 12px; }
            .love-promise p { font-size: 0.9rem; }
            .wechat-tip { padding: 12px 15px; margin-top: 15px; }
            .wechat-tip p { font-size: 0.85rem; }
        }
        
        /* è¶…å°å±æ‰‹æœº */
        @media (max-width: 360px) {
            .year-title { font-size: 1.4rem; }
            .time-box { padding: 8px 10px; min-width: 55px; }
            .time-value { font-size: 1.3rem; }
            .final-countdown { font-size: 6rem; }
            .new-year { font-size: 2.5rem; }
            .blessing-popup .emoji { font-size: 0.6rem; }
            .blessing-popup .text { font-size: 0.4rem; }
            .proposal-box h2 { font-size: 1.1rem; }
            .proposal-box .question { font-size: 0.95rem; }
            .success-title { font-size: 1.3rem; }
            .success-box p { font-size: 0.85rem; }
        }
        
        /* æ¬¢è¿ç•Œé¢ */
        .welcome-screen {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(135deg, #1a0a2e 0%, #2d1b4e 50%, #1a0a2e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
        }
        
        .welcome-screen.hidden {
            display: none;
        }
        
        .welcome-title {
            font-size: 2.5rem;
            color: #ff6b9d;
            text-shadow: 0 0 30px rgba(255, 107, 157, 0.8);
            margin-bottom: 20px;
            animation: welcomePulse 2s ease-in-out infinite;
        }
        
        .welcome-subtitle {
            font-size: 1.2rem;
            color: #ffb6c1;
            margin-bottom: 40px;
        }
        
        .welcome-btn {
            background: linear-gradient(45deg, #ff6b9d, #ff8a80);
            border: none;
            padding: 15px 50px;
            font-size: 1.3rem;
            color: white;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 30px rgba(255, 107, 157, 0.5);
            animation: welcomePulse 2s ease-in-out infinite;
            transition: transform 0.3s;
        }
        
        .welcome-btn:hover {
            transform: scale(1.1);
        }
        
        @keyframes welcomePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .welcome-hint {
            margin-top: 30px;
            font-size: 0.9rem;
            color: rgba(255, 182, 193, 0.7);
        }
        
        @media (max-width: 480px) {
            .welcome-title { font-size: 1.8rem; }
            .welcome-subtitle { font-size: 1rem; }
            .welcome-btn { padding: 12px 40px; font-size: 1.1rem; }
        }
    </style>
</head>
<body>
    <!-- æ¬¢è¿ç•Œé¢ -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-title">ğŸ’• ç»™ä½ çš„æƒŠå–œ ğŸ’•</div>
        <div class="welcome-subtitle">å‡†å¤‡å¥½äº†å—ï¼Ÿ</div>
        <button class="welcome-btn" id="enterBtn">ç‚¹å‡»è¿›å…¥ âœ¨</button>
        <div class="welcome-hint">ğŸµ è¯·æ‰“å¼€å£°éŸ³è·å¾—æœ€ä½³ä½“éªŒ</div>
    </div>

    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bgMusic" loop preload="auto">
        <source src="Taylor Swift - Love Story (The 1989 World Tour Live)_L.ogg" type="audio/ogg">
    </audio>
    
    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <button class="music-btn" id="musicBtn" title="æ’­æ”¾/æš‚åœéŸ³ä¹">ğŸµ</button>
    

    
    <div class="stars" id="stars"></div>
    
    <!-- å€’è®¡æ—¶é¡µé¢ -->
    <div class="countdown-page" id="countdownPage">
        <h1 class="year-title">ğŸŠ 2026æ–°å¹´å€’è®¡æ—¶ ğŸŠ</h1>
        <div class="countdown-display">
            <div class="time-box">
                <div class="time-value" id="days">00</div>
                <div class="time-label">å¤©</div>
            </div>
            <div class="time-box">
                <div class="time-value" id="hours">00</div>
                <div class="time-label">æ—¶</div>
            </div>
            <div class="time-box">
                <div class="time-value" id="minutes">00</div>
                <div class="time-label">åˆ†</div>
            </div>
            <div class="time-box">
                <div class="time-value" id="seconds">00</div>
                <div class="time-label">ç§’</div>
            </div>
        </div>
        <p style="color: #ffb6c1; font-size: 1.2rem;">ğŸ’• å’Œä½ ä¸€èµ·è¿æ¥æ–°å¹´ ğŸ’•</p>
    </div>
    
    <!-- çˆ±å¿ƒæ¥åŠ›æ¸¸æˆ -->
    <div class="game-container active" id="gameContainer">
        <div class="game-ui">
            <div class="game-score">çˆ±å¿ƒ: <span class="score-value" id="gameScore">0</span></div>
            <div class="game-lives" id="gameLives">&#10084;&#10084;&#10084;</div>
        </div>
        <div class="game-hint">&#128070; æ»‘åŠ¨å±å¹•ç§»åŠ¨ç¯®å­æ¥ä½çˆ±å¿ƒ<br>&#9888; èº²å¼€ç‚¸å¼¹!</div>
        <div class="heart-catcher" id="heartCatcher">&#128230;</div>
    </div>
    
    <!-- æ¸¸æˆç»“æŸå¼¹çª— -->
    <div class="game-over-popup" id="gameOverPopup">
        <h3>æ¸¸æˆç»“æŸ</h3>
        <div>ä½ æ”¶é›†äº†</div>
        <div class="final-score" id="finalGameScore">0</div>
        <div>ä¸ªçˆ±å¿ƒ!</div>
        <button class="restart-btn" id="restartBtn">å†ç©ä¸€æ¬¡</button>
    </div>
    
    <div class="final-countdown" id="finalCountdown"></div>
    <div class="new-year" id="newYear">2026</div>
    
    <!-- è¡¨ç™½å¼¹çª— -->
    <div class="proposal-modal" id="proposalModal">
        <div class="proposal-box">
            <h2>ğŸ’• é‡è¦çš„é—®é¢˜ ğŸ’•</h2>
            <p class="question">äº²çˆ±çš„ï¼Œ<br><span class="highlight">ä½ æ„¿æ„åšæˆ‘çš„å¥³æœ‹å‹å—ï¼Ÿ</span></p>
            <div class="proposal-buttons">
                <button class="btn-yes" id="btnYes">æ„¿æ„ ğŸ’•</button>
                <button class="btn-no" id="btnNo">æ‹’ç»</button>
            </div>
            <p class="reject-message" id="rejectMessage"></p>
        </div>
    </div>
    
    <!-- æˆåŠŸé¡µé¢ -->
    <div class="success-page" id="successPage">
        <div class="success-stars" id="successStars"></div>
        <div class="floating-hearts" id="floatingHearts"></div>
        <div class="success-content">
            <div class="big-heart">ğŸ’•</div>
            <h1 class="success-title">æˆ‘ä»¬åœ¨ä¸€èµ·å•¦</h1>
            <div class="success-box">
                <p>ä»è¿™ä¸€åˆ»èµ·</p>
                <p>ä½ æ˜¯æˆ‘çš„ <span class="highlight">å°å®è´</span></p>
                <p>æˆ‘æ˜¯ä½ çš„ <span class="highlight">ä¸“å±ç”·å‹</span></p>
                <p>å¾€åä½™ç”Ÿï¼Œé£é›ªæ˜¯ä½ ï¼Œå¹³æ·¡æ˜¯ä½ </p>
                <p>ç›®å…‰æ‰€è‡³ï¼Œä¹Ÿæ˜¯ä½  ğŸ’•</p>
                <div class="together-date">ğŸ’‘ åœ¨ä¸€èµ·çºªå¿µæ—¥ï¼š2026å¹´1æœˆ1æ—¥</div>
                <div class="love-promise">
                    <p>ğŸŒ¹ æˆ‘ä¼šæ°¸è¿œçˆ±ä½ ã€å® ä½ ã€ä¿æŠ¤ä½  ğŸŒ¹</p>
                </div>
                <div class="wechat-tip">
                    <p>ğŸ“± å·²å‘ä½ çš„å¾®ä¿¡å‘é€ä¸€æ¡çˆ±çš„æ¶ˆæ¯ ğŸ’Œ</p>
                    <p style="font-size: 0.9rem; margin-top: 5px;">å¿«å»æŸ¥çœ‹å§~</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è·¨å¹´ç¥ç¦è¯­ï¼ˆ100+æ¡ï¼‰
        const blessings = [
            { emoji: 'ğŸŠ', text: 'æ–°å¹´å¿«ä¹' }, { emoji: 'ğŸ‰', text: 'ä¸‡äº‹å¦‚æ„' }, { emoji: 'ğŸ’°', text: 'è´¢æºæ»šæ»š' },
            { emoji: 'ğŸ§§', text: 'æ­å–œå‘è´¢' }, { emoji: 'ğŸ’ª', text: 'èº«ä½“å¥åº·' }, { emoji: 'ğŸ¯', text: 'å¿ƒæƒ³äº‹æˆ' },
            { emoji: 'ğŸ’•', text: 'çˆ±æƒ…ç”œèœœ' }, { emoji: 'ğŸ“ˆ', text: 'äº‹ä¸šæœ‰æˆ' }, { emoji: 'ğŸ ', text: 'é˜–å®¶æ¬¢ä¹' },
            { emoji: 'ğŸ€', text: 'å¥½è¿è¿è¿' }, { emoji: 'ğŸ', text: 'è›‡å¹´å¤§å‰' }, { emoji: 'âœ¨', text: 'ä¸‡äº‹é¡ºé‚' },
            { emoji: 'ğŸ', text: 'æƒŠå–œä¸æ–­' }, { emoji: 'ğŸŒŸ', text: 'å‰é€”å…‰æ˜' }, { emoji: 'ğŸ†', text: 'å¹¸ç¦ç¾æ»¡' },
            { emoji: 'ğŸ’', text: 'å¯Œè´µå‰ç¥¥' }, { emoji: 'ğŸŒˆ', text: 'äº”å½©ç¼¤çº·' }, { emoji: 'ğŸ”¥', text: 'çº¢çº¢ç«ç«' },
            { emoji: 'ğŸ’«', text: 'æ˜Ÿå…‰ç’€ç’¨' }, { emoji: 'ğŸŒ¸', text: 'èŠ±å¼€å¯Œè´µ' }, { emoji: 'ğŸ¶', text: 'æ¬¢å£°ç¬‘è¯­' },
            { emoji: 'â¤ï¸', text: 'çˆ±ä½ æ°¸è¿œ' }, { emoji: 'ğŸŒ™', text: 'èŠ±å¥½æœˆåœ†' }, { emoji: 'â˜€ï¸', text: 'é˜³å…‰ç¿çƒ‚' },
            { emoji: 'ğŸ€', text: 'ç¾æ¢¦æˆçœŸ' }, { emoji: 'ğŸ’—', text: 'ç”œç”œèœœèœœ' }, { emoji: 'ğŸŒ¹', text: 'ç«ç‘°ç»½æ”¾' },
            { emoji: 'ğŸ‘‘', text: 'ç§°å¿ƒå¦‚æ„' }, { emoji: 'ğŸ¦‹', text: 'è¶èˆç¿©ç¿©' }, { emoji: 'ğŸ«', text: 'ç”Ÿæ´»ç”œèœœ' },
            { emoji: 'ğŸ’–', text: 'çˆ±æ„æ»¡æ»¡' }, { emoji: 'ğŸ‡', text: 'ç’€ç’¨å¤ºç›®' }, { emoji: 'ğŸ†', text: 'é©¬åˆ°æˆåŠŸ' },
            { emoji: 'ğŸ’', text: 'çœŸå¿ƒç›¸ä¼´' }, { emoji: 'ğŸŒº', text: 'ç¹èŠ±ä¼¼é”¦' }, { emoji: 'â­', text: 'æ˜Ÿè¾°å¤§æµ·' },
            { emoji: 'ğŸµ', text: 'å²æœˆé™å¥½' }, { emoji: 'ğŸ’', text: 'ç›¸æ¿¡ä»¥æ²«' }, { emoji: 'ğŸŒ»', text: 'å‘é˜³è€Œç”Ÿ' },
            { emoji: 'ğŸ€', text: 'å››å­£å¹³å®‰' }, { emoji: 'ğŸ’', text: 'é²œèŠ±ç››å¼€' }, { emoji: 'ğŸˆ', text: 'å¿«ä¹æ— é™' },
            { emoji: 'ğŸ¥‚', text: 'ä¸¾æ¯åŒåº†' }, { emoji: 'ğŸŠ', text: 'å–œæ°”æ´‹æ´‹' }, { emoji: 'ğŸ’°', text: 'æ—¥è¿›æ–—é‡‘' },
            { emoji: 'ğŸ§§', text: 'çº¢åŒ…å¤šå¤š' }, { emoji: 'ğŸ’ª', text: 'é¾™é©¬ç²¾ç¥' }, { emoji: 'ğŸ¯', text: 'æ¢¦æƒ³æˆçœŸ' },
            { emoji: 'ğŸ’•', text: 'ç™½å¤´å•è€' }, { emoji: 'ğŸ“ˆ', text: 'æ­¥æ­¥é«˜å‡' }, { emoji: 'ğŸ ', text: 'å®¶å’Œä¸‡äº‹å…´' },
            { emoji: 'ğŸ€', text: 'ç¦æ˜Ÿé«˜ç…§' }, { emoji: 'ğŸ', text: 'é‡‘è›‡çŒ®ç‘' }, { emoji: 'âœ¨', text: 'è¯¸äº‹çš†å®œ' },
            { emoji: 'ğŸ', text: 'å–œä»å¤©é™' }, { emoji: 'ğŸŒŸ', text: 'é¹ç¨‹ä¸‡é‡Œ' }, { emoji: 'ğŸ†', text: 'å›¢å›¢åœ†åœ†' },
            { emoji: 'ğŸ’', text: 'é‡‘ç‰æ»¡å ‚' }, { emoji: 'ğŸŒˆ', text: 'ç»šä¸½å¤šå½©' }, { emoji: 'ğŸ”¥', text: 'è’¸è’¸æ—¥ä¸Š' },
            { emoji: 'ğŸ’«', text: 'å…‰èŠ’ä¸‡ä¸ˆ' }, { emoji: 'ğŸŒ¸', text: 'æ˜¥æš–èŠ±å¼€' }, { emoji: 'ğŸ¶', text: 'å…¶ä¹èè' },
            { emoji: 'â¤ï¸', text: 'å¹¸ç¦æ°¸è¿œ' }, { emoji: 'ğŸŒ™', text: 'æœˆåœ†äººåœ†' }, { emoji: 'â˜€ï¸', text: 'æ¸©æš–å¦‚æ˜¥' },
            { emoji: 'ğŸ€', text: 'å¦‚æ„¿ä»¥å¿' }, { emoji: 'ğŸ’—', text: 'æ©çˆ±æœ‰åŠ ' }, { emoji: 'ğŸŒ¹', text: 'æµªæ¼«ä¸€ç”Ÿ' },
            { emoji: 'ğŸ‘‘', text: 'å¤§å±•å®å›¾' }, { emoji: 'ğŸ¦‹', text: 'è‡ªç”±è‡ªåœ¨' }, { emoji: 'ğŸ«', text: 'ç”œèœœå¹¸ç¦' },
            { emoji: 'ğŸ’–', text: 'çœŸçˆ±æ°¸æ’' }, { emoji: 'ğŸ‡', text: 'å…‰å½©ç…§äºº' }, { emoji: 'ğŸ†', text: 'æ——å¼€å¾—èƒœ' },
            { emoji: 'ğŸ’', text: 'æƒ…æ¯”é‡‘åš' }, { emoji: 'ğŸŒº', text: 'é”¦ç»£å‰ç¨‹' }, { emoji: 'â­', text: 'é—ªé—ªå‘å…‰' },
            { emoji: 'ğŸµ', text: 'å’Œå’Œç¾ç¾' }, { emoji: 'ğŸ’', text: 'å¤©é•¿åœ°ä¹…' }, { emoji: 'ğŸŒ»', text: 'æœæ°”è“¬å‹ƒ' },
            { emoji: 'ğŸ€', text: 'å‰ç¥¥å¦‚æ„' }, { emoji: 'ğŸ’', text: 'èŠ±å›¢é”¦ç°‡' }, { emoji: 'ğŸˆ', text: 'å¼€å¿ƒæ¯å¤©' },
            { emoji: 'ğŸ¥‚', text: 'å…±åº¦è‰¯å®µ' }, { emoji: 'ğŸŠ', text: 'æ¬¢å¤©å–œåœ°' }, { emoji: 'ğŸ’°', text: 'è´¢è¿äº¨é€š' },
            { emoji: 'ğŸ§§', text: 'å¤§å‰å¤§åˆ©' }, { emoji: 'ğŸ’ª', text: 'ç™¾ç—…ä¸ä¾µ' }, { emoji: 'ğŸ¯', text: 'ä¸‡äº‹äº¨é€š' },
            { emoji: 'ğŸ’•', text: 'æ‰§å­ä¹‹æ‰‹' }, { emoji: 'ğŸ“ˆ', text: 'å‰ç¨‹ä¼¼é”¦' }, { emoji: 'ğŸ ', text: 'æ¸©é¦¨ç¾æ»¡' },
            { emoji: 'ğŸ€', text: 'å‰æ˜Ÿé«˜ç…§' }, { emoji: 'ğŸ', text: 'è›‡å¹´è¡Œå¤§è¿' }, { emoji: 'âœ¨', text: 'ä¸€å¸†é£é¡º' },
            { emoji: 'ğŸ', text: 'å¥½äº‹è¿è¿' }, { emoji: 'ğŸŒŸ', text: 'å¤§å±•é¸¿å›¾' }, { emoji: 'ğŸ†', text: 'ç¾æ»¡å¹¸ç¦' },
            { emoji: 'ğŸ’', text: 'ç å…‰å®æ°”' }, { emoji: 'ğŸŒˆ', text: 'ä¸ƒå½©äººç”Ÿ' }, { emoji: 'ğŸ”¥', text: 'çƒ­æƒ…ä¼¼ç«' },
            { emoji: 'ğŸ’«', text: 'ç† ç† ç”Ÿè¾‰' }, { emoji: 'ğŸŒ¸', text: 'æ¡ƒèŠ±æœµæœµ' }, { emoji: 'ğŸ¶', text: 'ç¬‘å£å¸¸å¼€' },
            { emoji: 'â¤ï¸', text: 'ä¸€ç”Ÿä¸€ä¸–' }, { emoji: 'ğŸŒ™', text: 'çš“æœˆå½“ç©º' }, { emoji: 'â˜€ï¸', text: 'æ™´ç©ºä¸‡é‡Œ' },
            { emoji: 'ğŸ€', text: 'å¿ƒæ„¿è¾¾æˆ' }, { emoji: 'ğŸ’—', text: 'èœœé‡Œè°ƒæ²¹' }, { emoji: 'ğŸŒ¹', text: 'æƒ…æ·±æ„æµ“' }
        ];
        
        // åˆ›å»ºæ˜Ÿç©º
        function createStars() {
            const container = document.getElementById('stars');
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(star);
            }
        }
        createStars();

        // ========== çˆ±å¿ƒæ¥åŠ›æ¸¸æˆ ==========
        let gameScore = 0;
        let gameLives = 3;
        let combo = 0;
        let lastCatchTime = 0;
        let gameActive = true;
        let gameSpeed = 3000; // ä¸‹è½é€Ÿåº¦ï¼ˆæ¯«ç§’ï¼‰
        let spawnRate = 1200; // ç”Ÿæˆé—´éš”
        
        const gameHearts = ['\u2764', '\u2665', '\u2661', '\u2763', '\u2766', '\u2767', '\u2619'];
        const specialHearts = ['\u2605', '\u2606', '\u2736', '\u272A', '\u2730'];
        const catcher = document.getElementById('heartCatcher');
        const gameContainer = document.getElementById('gameContainer');
        let catcherX = window.innerWidth / 2 - 40;
        catcher.style.left = catcherX + 'px';
        
        // è§¦æ‘¸/é¼ æ ‡æ§åˆ¶ç¯®å­
        let isDragging = false;
        let touchStartX = 0;
        let catcherStartX = 0;
        
        function moveCatcher(clientX) {
            const newX = Math.max(0, Math.min(window.innerWidth - 80, clientX - 40));
            catcherX = newX;
            catcher.style.left = newX + 'px';
        }
        
        // è§¦æ‘¸äº‹ä»¶
        gameContainer.addEventListener('touchstart', (e) => {
            isDragging = true;
            touchStartX = e.touches[0].clientX;
            catcherStartX = catcherX;
        }, { passive: true });
        
        gameContainer.addEventListener('touchmove', (e) => {
            if (!isDragging || !gameActive) return;
            const deltaX = e.touches[0].clientX - touchStartX;
            moveCatcher(catcherStartX + deltaX + 40);
        }, { passive: true });
        
        gameContainer.addEventListener('touchend', () => { isDragging = false; });
        
        // é¼ æ ‡äº‹ä»¶ï¼ˆç”µè„‘ç«¯ï¼‰
        gameContainer.addEventListener('mousedown', (e) => {
            isDragging = true;
            touchStartX = e.clientX;
            catcherStartX = catcherX;
        });
        
        document.addEventListener('mousemove', (e) => {
            if (!isDragging || !gameActive) return;
            moveCatcher(e.clientX);
        });
        
        document.addEventListener('mouseup', () => { isDragging = false; });
        
        // é™€èºä»ªæ§åˆ¶ï¼ˆæ‰‹æœºå€¾æ–œï¼‰
        if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', (e) => {
                if (!gameActive || isDragging) return;
                const tilt = e.gamma; // -90 åˆ° 90
                if (tilt !== null) {
                    const sensitivity = 3;
                    const newX = catcherX + tilt * sensitivity * 0.1;
                    moveCatcher(Math.max(0, Math.min(window.innerWidth - 80, newX)) + 40);
                }
            });
        }
        
        // æ‰è½ç‰©å“æ•°ç»„
        let fallingItems = [];
        
        function createFallingItem() {
            if (!gameActive) return;
            
            // 15%æ¦‚ç‡ç”Ÿæˆç‚¸å¼¹ï¼Œ15%æ¦‚ç‡ç”Ÿæˆç‰¹æ®Šçˆ±å¿ƒ
            const rand = Math.random();
            const isBomb = rand < 0.15;
            const isSpecial = !isBomb && rand < 0.30;
            
            const item = document.createElement('div');
            item.className = isBomb ? 'falling-bomb' : 'falling-heart';
            
            if (isBomb) {
                item.textContent = '\u2620'; // éª·é«…ç¬¦å·ä»£æ›¿ç‚¸å¼¹
                item.dataset.type = 'bomb';
            } else if (isSpecial) {
                item.textContent = specialHearts[Math.floor(Math.random() * specialHearts.length)];
                item.dataset.type = 'special';
                item.classList.add('special');
            } else {
                item.textContent = gameHearts[Math.floor(Math.random() * gameHearts.length)];
                item.dataset.type = 'normal';
            }
            
            const startX = 30 + Math.random() * (window.innerWidth - 80);
            item.style.left = startX + 'px';
            item.style.top = '-50px';
            
            gameContainer.appendChild(item);
            
            // ä¸‹è½åŠ¨ç”»æ•°æ®
            const itemData = {
                element: item,
                x: startX,
                y: -50,
                speed: (2 + Math.random() * 2) * (1 + gameScore / 100), // éšåˆ†æ•°åŠ é€Ÿ
                type: item.dataset.type
            };
            fallingItems.push(itemData);
        }
        
        // æ¸¸æˆä¸»å¾ªç¯
        function gameLoop() {
            if (!gameActive) return;
            
            const catcherRect = {
                left: catcherX + 10,
                right: catcherX + 70,
                top: window.innerHeight - 90,
                bottom: window.innerHeight - 30
            };
            
            fallingItems = fallingItems.filter(item => {
                item.y += item.speed;
                item.element.style.top = item.y + 'px';
                
                const itemRect = {
                    left: item.x,
                    right: item.x + 40,
                    top: item.y,
                    bottom: item.y + 40
                };
                
                // ç¢°æ’æ£€æµ‹
                const collision = !(itemRect.right < catcherRect.left || 
                                   itemRect.left > catcherRect.right || 
                                   itemRect.bottom < catcherRect.top || 
                                   itemRect.top > catcherRect.bottom);
                
                if (collision) {
                    if (item.type === 'bomb') {
                        // ç¢°åˆ°ç‚¸å¼¹
                        item.element.classList.add('explode');
                        loseLife();
                        showScorePopup(item.x, item.y, 'BOOM!', true);
                        combo = 0;
                    } else {
                        // æ¥ä½çˆ±å¿ƒ
                        item.element.classList.add('caught');
                        const now = Date.now();
                        if (now - lastCatchTime < 800) combo++;
                        else combo = 1;
                        lastCatchTime = now;
                        
                        let points = item.type === 'special' ? 5 : 1;
                        if (combo >= 10) points *= 3;
                        else if (combo >= 5) points *= 2;
                        
                        gameScore += points;
                        document.getElementById('gameScore').textContent = gameScore;
                        showScorePopup(item.x, item.y, '+' + points);
                        
                        if (combo === 5) showComboText('5è¿å‡»! x2');
                        else if (combo === 10) showComboText('10è¿å‡»! x3');
                        else if (combo === 20) showComboText('è¶…ç¥!');
                    }
                    setTimeout(() => item.element.remove(), 300);
                    return false;
                }
                
                // æ‰å‡ºå±å¹•
                if (item.y > window.innerHeight) {
                    if (item.type !== 'bomb') {
                        // æ¼æ‰çˆ±å¿ƒ
                        item.element.classList.add('missed');
                        combo = 0;
                    }
                    setTimeout(() => item.element.remove(), 300);
                    return false;
                }
                
                return true;
            });
            
            requestAnimationFrame(gameLoop);
        }
        
        function loseLife() {
            gameLives--;
            updateLivesDisplay();
            
            // å±å¹•éœ‡åŠ¨æ•ˆæœ
            gameContainer.style.animation = 'none';
            gameContainer.offsetHeight;
            gameContainer.style.animation = 'shake 0.3s ease';
            
            if (gameLives <= 0) {
                endGame();
            }
        }
        
        function updateLivesDisplay() {
            const livesEl = document.getElementById('gameLives');
            livesEl.innerHTML = '\u2764'.repeat(gameLives) + '\u2661'.repeat(3 - gameLives);
        }
        
        function showScorePopup(x, y, text, isNegative = false) {
            const popup = document.createElement('div');
            popup.className = 'score-popup' + (isNegative ? ' negative' : '');
            popup.textContent = text;
            popup.style.left = x + 'px';
            popup.style.top = y + 'px';
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 800);
        }
        
        function showComboText(text) {
            const comboEl = document.createElement('div');
            comboEl.className = 'combo-text';
            comboEl.textContent = text;
            document.body.appendChild(comboEl);
            setTimeout(() => comboEl.remove(), 800);
        }
        
        function endGame() {
            gameActive = false;
            clearInterval(gameInterval);
            document.getElementById('finalGameScore').textContent = gameScore;
            document.getElementById('gameOverPopup').classList.add('show');
        }
        
        function restartGame() {
            gameScore = 0;
            gameLives = 3;
            combo = 0;
            gameActive = true;
            document.getElementById('gameScore').textContent = '0';
            updateLivesDisplay();
            document.getElementById('gameOverPopup').classList.remove('show');
            
            // æ¸…é™¤æ‰€æœ‰æ‰è½ç‰©
            fallingItems.forEach(item => item.element.remove());
            fallingItems = [];
            
            gameInterval = setInterval(createFallingItem, spawnRate);
            gameLoop();
        }
        
        document.getElementById('restartBtn').addEventListener('click', restartGame);
        
        // æ·»åŠ éœ‡åŠ¨åŠ¨ç”»
        const shakeStyle = document.createElement('style');
        shakeStyle.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                75% { transform: translateX(10px); }
            }
        `;
        document.head.appendChild(shakeStyle);
        
        // å¯åŠ¨æ¸¸æˆ
        let gameInterval = setInterval(createFallingItem, spawnRate);
        gameLoop();
        
        // æ¸¸æˆåœæ­¢å‡½æ•°ï¼ˆå€’è®¡æ—¶ç»“æŸæ—¶è°ƒç”¨ï¼‰
        function stopGame() {
            gameActive = false;
            clearInterval(gameInterval);
            const container = document.getElementById('gameContainer');
            container.classList.remove('active');
            container.style.display = 'none';
            document.getElementById('gameOverPopup').classList.remove('show');
        }
        // ========== æ¸¸æˆç»“æŸ ==========

        // åˆ›å»ºçƒŸèŠ±
        function createFirework(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            const colors = ['#ff6b9d', '#ff8a80', '#ffab91', '#f48fb1', '#ce93d8', '#ffb6c1', '#ffd700'];
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                const angle = (i / 20) * 360;
                const velocity = 40 + Math.random() * 60;
                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.background = color;
                particle.style.boxShadow = `0 0 6px ${color}`;
                const rad = angle * Math.PI / 180;
                const endX = Math.cos(rad) * velocity;
                const endY = Math.sin(rad) * velocity;
                particle.animate([
                    { transform: 'translate(0, 0)', opacity: 1 },
                    { transform: `translate(${endX}px, ${endY}px)`, opacity: 0 }
                ], { duration: 1000, easing: 'ease-out' });
                firework.appendChild(particle);
            }
            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1000);
        }
        
        // åˆ›å»ºçˆ±å¿ƒé£˜è½
        function createHeartRain() {
            const hearts = ['ğŸ’•', 'ğŸ’—', 'ğŸ’–', 'ğŸ’', 'â¤ï¸', 'ğŸ’“', 'ğŸ’', 'ğŸŒ¸', 'âœ¨'];
            const heart = document.createElement('div');
            heart.className = 'heart-rain';
            heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
            heart.style.left = Math.random() * 100 + '%';
            heart.style.top = '-30px';
            heart.style.fontSize = (1 + Math.random() * 1.5) + 'rem';
            heart.style.animationDuration = (4 + Math.random() * 3) + 's';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 7000);
        }
        
        // ç”Ÿæˆçˆ±å¿ƒå½¢çŠ¶åæ ‡ï¼ˆæ”¯æŒ100+ç‚¹ï¼‰
        function getHeartPositions(count) {
            const positions = [];
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const scale = Math.min(window.innerWidth, window.innerHeight) * 0.42;
            for (let i = 0; i < count; i++) {
                const t = (i / count) * Math.PI * 2;
                const x = 16 * Math.pow(Math.sin(t), 3);
                const y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                positions.push({
                    x: centerX + (x / 16) * scale - 35,
                    y: centerY + (y / 16) * scale - 25
                });
            }
            return positions;
        }
        
        // åˆ›å»ºç¥ç¦å¼¹çª—
        function createBlessingPopup(blessing, pos, delay) {
            setTimeout(() => {
                const popup = document.createElement('div');
                popup.className = 'blessing-popup';
                popup.style.left = pos.x + 'px';
                popup.style.top = pos.y + 'px';
                popup.innerHTML = `<span class="emoji">${blessing.emoji}</span><span class="text">${blessing.text}</span>`;
                document.body.appendChild(popup);
            }, delay);
        }
        
        // åŒ—äº¬æ—¶é—´å€’è®¡æ—¶
        // ç›®æ ‡æ—¶é—´ï¼šåŒ—äº¬æ—¶é—´2026å¹´1æœˆ1æ—¥00ç‚¹00åˆ†
        const targetDate = new Date('2026-01-01T00:00:00+08:00');
        let countdownEnded = false;
        let lastSecond = -1;
        let finalCountdownStarted = false;
        
        function updateCountdown() {
            const now = new Date();
            const diff = targetDate.getTime() - now.getTime();
            
            if (diff <= 0 && !countdownEnded) {
                countdownEnded = true;
                startNewYear();
                return;
            }
            
            if (diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
                
                // æœ€å10ç§’å¤§å€’è®¡æ—¶
                if (diff <= 10000 && !finalCountdownStarted) {
                    finalCountdownStarted = true;
                    document.getElementById('countdownPage').classList.add('hidden');
                    // è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
                    playMusic();
                }
                
                // è®¡ç®—æœ€å10ç§’å†…çš„ç§’æ•°
                const finalSeconds = Math.ceil(diff / 1000);
                if (finalCountdownStarted && finalSeconds !== lastSecond && finalSeconds > 0 && finalSeconds <= 10) {
                    lastSecond = finalSeconds;
                    showFinalCountdown(finalSeconds);
                }
            }
        }

        // æ˜¾ç¤ºæœ€åå€’è®¡æ—¶æ•°å­—
        function showFinalCountdown(num) {
            const el = document.getElementById('finalCountdown');
            el.textContent = num;
            el.classList.remove('show');
            void el.offsetWidth;
            el.classList.add('show');
            createFirework(Math.random() * window.innerWidth, Math.random() * window.innerHeight * 0.5);
        }
        
        // å¼€å§‹æ–°å¹´
        function startNewYear() {
            document.getElementById('countdownPage').classList.add('hidden');
            stopGame(); // åœæ­¢çˆ±å¿ƒæ”¶é›†æ¸¸æˆ
            const newYear = document.getElementById('newYear');
            newYear.classList.add('show');
            
            // å¤§é‡çƒŸèŠ±
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createFirework(Math.random() * window.innerWidth, Math.random() * window.innerHeight * 0.6);
                }, i * 100);
            }
            
            // 2ç§’åæ˜¾ç¤ºçˆ±å¿ƒå¼¹çª—
            setTimeout(() => {
                newYear.classList.remove('show');
                newYear.classList.add('move-up');
                showBlessings();
            }, 2000);
        }
        
        // æ˜¾ç¤ºç¥ç¦å¼¹çª—
        function showBlessings() {
            const heartPositions = getHeartPositions(blessings.length);
            blessings.forEach((blessing, index) => {
                createBlessingPopup(blessing, heartPositions[index], index * 30);
            });
            
            // å¼¹çª—å…¨éƒ¨å‡ºç°åæ˜¾ç¤ºè¡¨ç™½å¼¹çª—
            setTimeout(() => {
                document.getElementById('proposalModal').classList.add('show');
            }, blessings.length * 30 + 1000);
            
            // æŒç»­çƒŸèŠ±
            setInterval(() => {
                createFirework(Math.random() * window.innerWidth, Math.random() * window.innerHeight * 0.6);
            }, 600);
            
            // çˆ±å¿ƒé£˜è½
            setInterval(createHeartRain, 150);
        }
        
        // å¯åŠ¨å€’è®¡æ—¶
        setInterval(updateCountdown, 100);
        updateCountdown();
        
        // æµ‹è¯•æ¨¡å¼å‡½æ•°
        function startTestMode() {
            if (!countdownEnded) {
                document.getElementById('countdownPage').classList.add('hidden');
                // æ’­æ”¾éŸ³ä¹
                playMusic();
                // æ¨¡æ‹Ÿ10ç§’å€’è®¡æ—¶
                let count = 10;
                const countInterval = setInterval(() => {
                    if (count > 0) {
                        showFinalCountdown(count);
                        count--;
                    } else {
                        clearInterval(countInterval);
                        countdownEnded = true;
                        startNewYear();
                    }
                }, 1000);
            }
        }
        
        // æµ‹è¯•æ¨¡å¼ï¼šæŒ‰ T é”®è·³åˆ°æœ€å10ç§’ï¼ˆç”µè„‘ç«¯ï¼‰
        document.addEventListener('keydown', (e) => {
            if (e.key === 't' || e.key === 'T') {
                startTestMode();
            }
        });
        
        // éŸ³ä¹æ§åˆ¶
        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        let musicPlaying = false;
        
        function playMusic() {
            if (!musicPlaying) {
                bgMusic.currentTime = 52; // ä»52ç§’å¼€å§‹æ’­æ”¾
                bgMusic.play().then(() => {
                    musicPlaying = true;
                    musicBtn.textContent = 'ğŸ¶';
                    musicBtn.classList.add('playing');
                }).catch(() => {});
            }
        }
        
        function toggleMusic() {
            if (musicPlaying) {
                bgMusic.pause();
                musicBtn.textContent = 'ğŸµ';
                musicBtn.classList.remove('playing');
                musicPlaying = false;
            } else {
                playMusic();
            }
        }
        
        musicBtn.addEventListener('click', toggleMusic);
        
        // æ¬¢è¿ç•Œé¢ - ç‚¹å‡»è¿›å…¥å¹¶æ’­æ”¾éŸ³ä¹
        const welcomeScreen = document.getElementById('welcomeScreen');
        const enterBtn = document.getElementById('enterBtn');
        
        function enterPage() {
            // éšè—æ¬¢è¿ç•Œé¢
            welcomeScreen.classList.add('hidden');
            // æ’­æ”¾éŸ³ä¹
            playMusic();
        }
        
        // ç‚¹å‡»æŒ‰é’®æˆ–æ•´ä¸ªæ¬¢è¿ç•Œé¢éƒ½å¯ä»¥è¿›å…¥
        enterBtn.addEventListener('click', enterPage);
        welcomeScreen.addEventListener('click', enterPage);
        // æ‰‹æœºè§¦æ‘¸æ”¯æŒ
        welcomeScreen.addEventListener('touchstart', enterPage, { once: true });
        
        // ç‚¹å‡»æ”¾çƒŸèŠ±
        document.addEventListener('click', (e) => {
            if (!e.target.closest('button') && !e.target.closest('.music-btn')) {
                createFirework(e.clientX, e.clientY);
            }
        });
        
        // æ‹’ç»æ—¶çš„è¯è¯­
        const rejectMessages = [
            "ä¸è¡Œå“¦ï¼Œå†æƒ³æƒ³å˜›~ ğŸ’•", "äººå®¶ä¸æ¥å—æ‹’ç»çš„ï¼ğŸ¥º", "ä½ ç¡®å®šå—ï¼Ÿå†è€ƒè™‘ä¸€ä¸‹ï¼ŸğŸ’—",
            "æ‹’ç»æ— æ•ˆï¼é‡æ–°é€‰æ‹©ï¼ğŸ˜¤", "ä¸å¯ä»¥æ‹’ç»æˆ‘ï¼ğŸ’”", "ä½ å¿å¿ƒæ‹’ç»æˆ‘å—ï¼ŸğŸ¥¹",
            "è¿™ä¸ªæŒ‰é’®åäº†ï¼Œç‚¹å¦ä¸€ä¸ªå§~ ğŸ’–", "æˆ‘ä¸å¬æˆ‘ä¸å¬ï¼ğŸ’•", "å†ç‚¹ä¸€ç™¾æ¬¡ä¹Ÿæ²¡ç”¨å“¦~ ğŸ˜˜",
            "ä½ çš„æ‹’ç»æˆ‘ä¸æ¥å—ï¼â¤ï¸", "ä¸è¡Œä¸è¡Œï¼Œå¿…é¡»åŒæ„ï¼ğŸ’—", "æˆ‘ä¼šä¸€ç›´ç­‰ä½ ç‚¹åŒæ„çš„~ ğŸŒ¹",
            "æ‹’ç»çš„è¯æˆ‘ä¼šä¼¤å¿ƒçš„... ğŸ˜¢", "ç»™ä¸ªæœºä¼šå˜›~ ğŸ’•", "ä½ çœ‹æˆ‘è¿™ä¹ˆå¯çˆ±ï¼ŒåŒæ„å§ï¼ğŸ¥°"
        ];
        
        let rejectCount = 0;
        
        // æˆåŠŸé¡µé¢æ•ˆæœ
        function createSuccessStars() {
            const container = document.getElementById('successStars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(star);
            }
        }
        
        function createFloatingHearts() {
            const container = document.getElementById('floatingHearts');
            const hearts = ['ğŸ’•', 'ğŸ’—', 'ğŸ’–', 'ğŸ’', 'â¤ï¸', 'ğŸ’“', 'ğŸ’', 'ğŸŒ¹', 'âœ¨', 'ğŸ’«'];
            for (let i = 0; i < 25; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDelay = Math.random() * 4 + 's';
                heart.style.fontSize = (1.5 + Math.random() * 2) + 'rem';
                container.appendChild(heart);
            }
        }
        
        // åŒæ„æŒ‰é’®
        document.getElementById('btnYes').addEventListener('click', () => {
            document.getElementById('proposalModal').classList.remove('show');
            document.getElementById('successPage').classList.add('show');
            createSuccessStars();
            createFloatingHearts();
            
            // ç–¯ç‹‚æ”¾çƒŸèŠ±
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    createFirework(Math.random() * window.innerWidth, Math.random() * window.innerHeight * 0.7);
                }, i * 80);
            }
            
            setInterval(() => {
                createFirework(Math.random() * window.innerWidth, Math.random() * window.innerHeight * 0.5);
            }, 300);
            
            setInterval(createHeartRain, 150);
        });
        
        // æ‹’ç»æŒ‰é’®
        document.getElementById('btnNo').addEventListener('click', () => {
            const message = rejectMessages[rejectCount % rejectMessages.length];
            document.getElementById('rejectMessage').textContent = message;
            rejectCount++;
            
            const btnNo = document.getElementById('btnNo');
            if (rejectCount > 2) {
                const randomX = (Math.random() - 0.5) * 100;
                const randomY = (Math.random() - 0.5) * 50;
                btnNo.style.transform = `translate(${randomX}px, ${randomY}px)`;
            }
            
            const btnYes = document.getElementById('btnYes');
            btnYes.style.transform = `scale(${1 + rejectCount * 0.1})`;
        });
    </script>
</body>
</html>
